package com.codeboy.dto;

import com.codeboy.model.vulnerability.VulnerabilityModel;
import com.codeboy.model.weakness.WeaknessModel;

import java.util.List;

public class VulnerabilityDto {
    private String id;
    public String category;
    public String name;
    public String description;
    public String cve;
    public String severity;
    public String locationFile;
    public String locationLineStart;
    public String locationLineEnd;
    private List<WeaknessDto> weaknesses;

    public VulnerabilityDto(String id, String category, String name, String description, String cve, String severity, String locationFile, String locationLineStart, List<WeaknessDto> weaknesses) {
        this.id = id;
        this.category = category;
        this.name = name;
        this.description = description;
        this.cve = cve;
        this.severity = severity;
        this.locationFile = locationFile;
        this.locationLineStart = locationLineStart;
        this.weaknesses = weaknesses;
    }

    public static VulnerabilityDto from(VulnerabilityModel vulnerability, List<WeaknessDto> weaknesses) {
        return new VulnerabilityDto(
                String.valueOf(vulnerability.getId()),
                vulnerability.getCategory(),
                vulnerability.getName(),
                vulnerability.getDescription(),
                vulnerability.getCve(),
                vulnerability.getSeverity(),
                vulnerability.getLocationFile(),
                vulnerability.getLocationLineStart(),
                weaknesses
        );
    }

    public String getId() {
        return id;
    }

    public String getCategory() {
        return category;
    }

    public String getName() {
        return name;
    }

    public String getDescription() {
        return description;
    }

    public String getCve() {
        return cve;
    }

    public String getSeverity() {
        return severity;
    }

    public String getLocationFile() {
        return locationFile;
    }

    public String getLocationLineStart() {
        return locationLineStart;
    }

    public String getLocationLineEnd() {
        return locationLineEnd;
    }

    public List<WeaknessDto> getWeaknesses() {
        return this.weaknesses;
    }

    public VulnerabilityModel toModel() {
        return new VulnerabilityModel(
                this.getCategory(),
                this.getName(),
                this.getDescription(),
                this.getCve(),
                this.getSeverity(),
                this.getLocationFile(),
                this.getLocationLineStart()
        );
    }

    @Override
    public String toString() {
        return "id: " + this.id + ", severity: " + this.severity + ", category: " + this.category + ", name: " + this.name;
    }
}

