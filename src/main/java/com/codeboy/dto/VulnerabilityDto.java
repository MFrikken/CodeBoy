package com.codeboy.dto;

import com.codeboy.model.vulnerability.VulnerabilityModel;
import com.codeboy.model.weakness.WeaknessModel;

import java.util.List;

public class VulnerabilityDto extends VulnerabilityModel {
    private List<WeaknessModel> weaknesses;

    public VulnerabilityDto(Integer id, String category, String name, String description, String cve, String severity, String locationFile, String locationLineStart, List<WeaknessModel> weaknesses) {
        super(category, name, description, cve, severity, locationFile, locationLineStart);
        this.weaknesses = weaknesses;
    }

    public VulnerabilityDto(VulnerabilityModel vulnerability, List<WeaknessModel> weaknesses) {
        super(
                vulnerability.getCategory(),
                vulnerability.getName(),
                vulnerability.getDescription(),
                vulnerability.getCve(),
                vulnerability.getSeverity(),
                vulnerability.getLocationFile(),
                vulnerability.getLocationLineStart()
        );
        this.weaknesses = weaknesses;
    }

    public List<WeaknessModel> getWeaknesses() {
        return this.weaknesses;
    }

    public VulnerabilityModel toModel() {
        return new VulnerabilityModel(
                this.getCategory(),
                this.getName(),
                this.getDescription(),
                this.getCve(),
                this.getSeverity(),
                this.getLocationFile(),
                this.getLocationLineStart()
        );
    }
}
