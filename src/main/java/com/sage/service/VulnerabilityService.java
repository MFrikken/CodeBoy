package com.sage.service;

import com.sage.dto.VulnerabilityDto;
import com.sage.model.vulnerability.VulnerabilityModel;
import com.sage.model.weakness.WeaknessModel;
import com.sage.repository.VulnerabilityRepository;
import com.sage.repository.WeaknessRepository;

import java.util.HashMap;
import java.util.List;

public class VulnerabilityService {
    private VulnerabilityRepository vulnerabilityRepository;
    private WeaknessRepository weaknessRepository;

    public VulnerabilityService() {
        this.vulnerabilityRepository = new VulnerabilityRepository();
        this.weaknessRepository = new WeaknessRepository();
    }

    public HashMap<String, Integer> getStatistics() {
        HashMap<String, Integer> statistics = this.vulnerabilityRepository.fetchStatistics();
        return statistics;
    }

    public VulnerabilityDto getById(Integer id) {
        VulnerabilityModel vulnerability = this.vulnerabilityRepository.getByID(id);
        List<WeaknessModel> weaknesses = this.weaknessRepository.getAllByVulnerabilityId(id);
        return vulnerability.toDto(weaknesses);
    }

    public void getAll() {
        // TODO: implement method
    }
}
